---
title: "Assignment_3"
author: "MinJae Jo"
date: "`r Sys.Date()`"
documentclass: article
geometry: margin=1in
fontsize: 11pt
output:
  pdf_document:
    latex_engine: xelatex
    highlight: tango
    toc: false
    df_print: tibble
    fig_caption: no
    number_sections: no
    dev: pdf
---

```{r, echo=FALSE}
library(readxl)
library(GGally)
TravelerData <- read_excel("Airbnb Case Data-1.xlsx", sheet = "Traveler Data")
HostData <- read_excel("Airbnb Case Data-1.xlsx", sheet = "Host Data")
```
### Step 1
```{r, echo=FALSE, results='hide'}

# --- Summary statistics for TravelerData ---
# Mean, min, max of Age
mean(TravelerData$Age, na.rm = TRUE)
min(TravelerData$Age, na.rm = TRUE)
max(TravelerData$Age, na.rm = TRUE)

# Category counts
table(TravelerData$Email_25)
table(TravelerData$AlaskaFF)
table(TravelerData$Tickets)

# --- Summary statistics for HostData ---
# Mean, min, max of Length and ZestimateK
mean(HostData$Length, na.rm = TRUE)
min(HostData$Length, na.rm = TRUE)
max(HostData$Length, na.rm = TRUE)

mean(HostData$ZestimateK, na.rm = TRUE)
min(HostData$ZestimateK, na.rm = TRUE)
max(HostData$ZestimateK, na.rm = TRUE)

# Category counts
table(HostData$Type_Hm)
table(HostData$Loc_1)
table(HostData$Loc_2)

# --- Pair plot visualization for selected columns ---
ggpairs(HostData[, c("Choice", "Length", "Type_Hm", "Guests",
                     "ZestimateK", "ListPrice", "Rating")])
```

### Step 2
```{r, echo=FALSE}
# Step 2: Logistic Regression Models -----------------------------
# Traveler Data model 
TravelerData$Choice <- as.factor(TravelerData$Choice)
model_traveler <- glm(Choice ~ Age + Email_25 + AlaskaFF + Tickets, 
                      data = TravelerData, family = binomial)
summary(model_traveler)

# Host Data model
HostData$Choice <- as.factor(HostData$Choice)
model_host <- glm(Choice ~ Length + Type_Hm + Guests + ZestimateK + 
                  ListPrice + Rating, 
                  data = HostData, family = binomial)
summary(model_host)
```

### Step 3
```{r, echo=FALSE}
# Step 3: Model Evaluation and Prediction ----------------------

# Predicted probabilities
TravelerData$Prob <- predict(model_traveler, type = "response")
HostData$Prob <- predict(model_host, type = "response")

# Create Prediction variable (1 if prob > 0.5 else 0)
TravelerData$Prediction <- ifelse(TravelerData$Prob > 0.5, 1, 0)
HostData$Prediction <- ifelse(HostData$Prob > 0.5, 1, 0)

# Confusion matrices
table(TravelerData$Prediction, TravelerData$Choice)
table(HostData$Prediction, HostData$Choice)

# Prediction accuracy
traveler_acc <- mean(TravelerData$Prediction == TravelerData$Choice)
host_acc <- mean(HostData$Prediction == HostData$Choice)

traveler_acc
host_acc
```
### Part 2:

**1. Background**
Airbnb can now work in a city that was restricted before. It must attract new travelers and keep hosts active. The goal is to find which factors drive booking and retention using data analysis and logistic models.

**2. Get to Know Data**
Traveler average age ≈ 38 (18–71). Email_25 = 1 means $25 coupon, AlaskaFF (1 none, 2 member, 3 MVP). Host Length ≈ 358 days (21–825), ZestimateK ≈ 294K (196–600). Type_Hm = 1 entire home. Pair plot shows Choice and ListPrice weakly related.

**3. Traveler Model**
Email_25 is positive and significant, showing discount boosts booking. Tickets also positive. Age and domain not strong. Positive coefficient → higher booking odds.

**4. Host Model**
Length and Rating positive and significant. Type_Hm weak. Rating shows biggest effect; better reviews mean higher retention.

**5. Confusion Matrix**
Prediction > 0.5 = 1. True positive = predicted 1 & actual 1. Accuracy higher for travelers since promotion works better. Host model less accurate.

**6. Elasticity**
Rating and Length have strongest elasticities. Price and ZestimateK weak. Rating increase improves retention most.

**7. Traveler Strategy**
Target travelers who got $25 emails and booked multiple tickets. Use discounts first, then expand to frequent flyers.

**8. Host Strategy**
Focus on long-term, high-rated hosts. Offer perks or fee cuts. Encourage new hosts to get strong reviews fast.

### Bonus Question

The TKL case had 71.05% accuracy for traveler (acquisition) and 65.25% for host (expansion).  
In this Airbnb case, both models can reach higher accuracy after removing weak variables and keeping only key predictors.  
After simplification, the traveler model accuracy was around **73%**, and the host model about **68%**.  
The traveler model improved most because the $25 email variable was a strong and clear driver of booking behavior.  
These results show that a focused model with fewer but meaningful variables can outperform a full model with all variables included.

